"use strict";angular.module("myAppApp",["ngCookies","ngRoute"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/dashboard.html",controller:"DashboardCtrl",controllerAs:"dashboard"}).when("/signin",{templateUrl:"views/signin.html",controller:"SigninCtrl",controllerAs:"signin"}).when("/todolist",{templateUrl:"views/todolist.html",controller:"ToDoList",controllerAs:"todolist"}).otherwise({redirectTo:"/"})}]),angular.module("myAppApp").run(function(){setTimeout(function(){$(".loader").fadeOut("slow")},1e3)}),angular.module("myAppApp").controller("SigninCtrl",["VKService","$cookies","$location","$rootScope",function(a,b,c,d){d.uid&&c.path("/"),$(".vk").unbind("click"),$(".vk").bind("click",function(){a.LogInEvent()})}]),angular.module("myAppApp").controller("DashboardCtrl",["$cookies","$location","$scope","$rootScope","APIService",function(a,b,c,d,e){function f(){e.getEvents(d.uid).then(function(a){var a=a.data;if(a.type){a.data.forEach(function(a){a.date=new Date(a.date)}),c.events=a.data;var b=$("#calendar").data("DateTimePicker").date();c.eventsShow=[],c.events.forEach(function(a){a.date.getDate()==b._d.getDate()&&c.eventsShow.push(a)})}})}d.uid||b.path("/signin"),c.description="",c.events=[],c.eventsShow=[],$("#calendar").datetimepicker({inline:!0,format:"MM/dd/YYYY"}),$("#calendar *").on("click",function(){f()}),c.openMenu=function(){c.$emit("openLeftMenu")},c.openPopup=function(){$(".popup-wraper").toggle()},c.closePopup=function(){$(".popup-wraper").toggle()},c.AddEvent=function(){var a=$("#calendar").data("DateTimePicker").date();e.createEvent(c.description,a._d,d.uid)},f()}]),angular.module("myAppApp").controller("ToDoList",["$location","$rootScope","APIService","$scope",function(a,b,c,d){b.uid||a.path("/signin"),d.events=[],d.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],d.openMenu=function(){d.$emit("openLeftMenu")},d.Skip=function(a){c.deleteEvent(a).then(function(a){e()})};var e=function(){c.getEvents(b.uid).then(function(a){var a=a.data;a.type&&(a.data.forEach(function(a){a.date=new Date(a.date)}),d.events=a.data)})};e()}]),angular.module("myAppApp").factory("VKService",["$cookies","$location","APIService","$rootScope",function(a,b,c,d){VK.init({apiId:5360849});var e=!1;return{LogInEvent:function(){VK.Auth.login(this.LogInCallback)},LogInCallback:function(a){a.session&&(d.firstName=a.session.user.first_name,d.lastName=a.session.user.last_name,c.login("vk",a.session.user.id).then(function(a){d.uid=a.data.data,e?document.location="/#/":e=!0}),VK.Api.call("users.get",{uids:a.session.user.id,fields:"photo_200_orig"},function(a){a.response&&(d.uphoto=a.response[0].photo_200_orig,e?document.location="/#/":e=!0)}))}}}]),angular.module("myAppApp").factory("APIService",["$cookies","$location","$http",function(a,b,c){var d="http://0.0.0.0:9999";return{login:function(a,b){return c({method:"POST",url:d+"/login",data:{id_type:a,id_value:b}})},getEvents:function(a){return c({method:"GET",url:d+"/events/"+a})},deleteEvent:function(a){return c({method:"DELETE",url:d+"/devent/"+a})},createEvent:function(a,b,e){return c({method:"POST",url:d+"/event",data:{description:a,date:b,userId:e}})}}}]),angular.module("myAppApp").directive("leftMenu",["$rootScope",function(a){return{restrict:"E",templateUrl:"views/left-menu.html",controller:["$scope","$rootScope",function(a,b){a.$on("openLeftMenu",function(a,b){$("left-menu").animate({left:"0px"},1e3)}),a.$on("closeLeftMenu",function(a,b){$("left-menu").animate({left:"-300px"},1e3)}),a.close=function(){a.$emit("closeLeftMenu")}}]}}]),angular.module("myAppApp").run(["$templateCache",function(a){a.put("views/dashboard.html",'<header class="row"> <div class="col-sm-2 col-xs-12 text-center"> <i class="fa fa-bars" aria-hidden="true" ng-click="openMenu()"></i> PlaneIT <img src="../images/232663696.50b2081c.png"> </div> <div class="col-sm-8 col-xs-12 head text-center"> Calendar </div> </header> <div class="container content"> <div class="row"> <div class="col-sm-8 col-xs-12"> <div id="calendar"></div> <div class="add-event" ng-click="openPopup()"><i class="fa fa-plus" aria-hidden="true"></i></div> </div> <div class="col-sm-4 col-xs-12"> <div id="events"> <div class="groupe"> <div class="event" ng-repeat="event_item in eventsShow"> <div class="date">{{ event_item.date.getDate() }} {{ monthNames[event_item.date.getMonth()] }}</div> <div class="time">{{ event_item.date.getHours() }}:{{ event_item.date.getMinutes() }}</div> <div class="event-description">{{ event_item.description }}</div> <div class="action" ng-click="Skip(event_item.id)">Skip</div> </div> </div> </div> </div> </div> </div> <div class="popup-wraper" style="display:none"> <div class="popup"> <h1 class="text-center">Add new event</h1> <textarea placeholder="Description" ng-model="description"></textarea> <input type="button" ng-click="AddEvent()" value="Add"> <div class="popup-close" ng-click="closePopup()"><i class="fa fa-times" aria-hidden="true"></i></div> </div> </div>'),a.put("views/left-menu.html",'<div class="left-menu"> <div class="close text-right"> <i class="fa fa-angle-double-left" aria-hidden="true" ng-click="close()"></i> </div> <div class="top"> <div class="ava"> <img src="{{ $root.uphoto }}"> </div> <div class="name">{{ $root.firstName }} {{ $root.lastName }}</div> </div> <div class="menu"> <ul> <li><a href="/#/"><i class="fa fa-calendar-o" aria-hidden="true"></i>Calendar</a></li> <li><a href="/#/todolist"><i class="fa fa-list" aria-hidden="true"></i>To do board</a></li> <li><i class="fa fa-pencil" aria-hidden="true"></i>Notes</li> </ul> <ul> <li><a href="http://vk.com/id32682972" target="_blank"><i class="fa fa-question-circle" aria-hidden="true"></i>Help</a></li> <li><a href="http://vk.com/id32682972" target="_blank"><i class="fa fa-comment" aria-hidden="true"></i>Feedback</a></li> </ul> </div> </div>'),a.put("views/signin.html",'<header class="row"> <div class="col-sm-12 col-xs-12"> PlaneIT <img src="../images/232663696.50b2081c.png"> </div> </header> <div class="row"> <div class="col-sm-6 col-xs-10 col-sm-offset-3 col-xs-offset-1 signin text-center"> <h2>Log In</h2> Choose the program you wanna log in with: <div class="row col-sm-10 col-sm-offset-1"> <div class="col-sm-3 fb"> <img src="../images/planet2.a0fc95e1.png"> </div> <div class="col-sm-3 gp"> <img src="../images/planet1.22baa435.png"> </div> <div class="col-sm-3 vk"> <img src="../images/planet2.a0fc95e1.png"> </div> <div class="col-sm-3 gh"> <img src="../images/planet3.23d33e1d.png"> </div> </div> </div> </div>'),a.put("views/todolist.html",'<header class="row"> <div class="col-sm-2 col-xs-12 text-center"> <i class="fa fa-bars" aria-hidden="true" ng-click="openMenu()"></i> PlaneIT <img src="../images/232663696.50b2081c.png"> </div> <div class="col-sm-8 col-xs-12 head text-center"> To do board </div> </header> <div class="container content"> <div class="row board"> <div class="col-sm-4 col-xs-12" ng-repeat="event_item in events"> <div class="event"> <div class="date">{{ event_item.date.getDate() }} {{ monthNames[event_item.date.getMonth()] }}</div> <div class="time">{{ event_item.date.getHours() }}:{{ event_item.date.getMinutes() }}</div> <div class="event-description">{{ event_item.description }}</div> <div class="action" ng-click="Skip(event_item.id)">Skip</div> </div> </div> </div> </div>')}]);